2025-03-10 11:45:38,074 — model_validator — INFO — Starting model validation with model: data/models/lstm_BTCUSDT_15m.h5
2025-03-10 11:45:38,075 — model_validator — INFO — Using validation data: data/processed/BTCUSDT_15m_val.csv
2025-03-10 11:45:38,076 — model_validator — INFO — Loading model...
2025-03-10 11:45:38,078 — model_validator — ERROR — Error during model validation: [Errno 2] Unable to synchronously open file (unable to open file: name = 'data/models/lstm_BTCUSDT_15m.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
2025-03-10 11:45:38,112 — model_validator — ERROR — Traceback (most recent call last):
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 893, in <module>
    model = tf.keras.models.load_model(args.model_path)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\keras\src\saving\saving_api.py", line 183, in load_model
    return legacy_h5_format.load_model_from_hdf5(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\keras\src\legacy\saving\legacy_h5_format.py", line 116, in load_model_from_hdf5
    f = h5py.File(filepath, mode="r")
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\h5py\_hl\files.py", line 562, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\h5py\_hl\files.py", line 235, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h5py\\_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py\\_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py\\h5f.pyx", line 102, in h5py.h5f.open
FileNotFoundError: [Errno 2] Unable to synchronously open file (unable to open file: name = 'data/models/lstm_BTCUSDT_15m.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)

2025-03-10 11:47:15,950 — model_validator — INFO — Starting model validation with model: data/models/lstm_BTCUSDT_15m.h5
2025-03-10 11:47:15,951 — model_validator — INFO — Using validation data: data/processed/BTCUSDT_15m_val.csv
2025-03-10 11:47:15,952 — model_validator — INFO — Found model at data/models/lstm_BTCUSDT_15m.keras instead of data/models/lstm_BTCUSDT_15m.h5
2025-03-10 11:47:15,952 — model_validator — INFO — Loading model from data/models/lstm_BTCUSDT_15m.keras...
2025-03-10 11:47:16,512 — model_validator — INFO — Loading validation data...
2025-03-10 11:47:16,513 — model_validator — ERROR — Validation data file not found: data/processed/BTCUSDT_15m_val.csv
2025-03-10 11:51:19,845 — model_validator — INFO — Starting model validation with model: data/models/lstm_BTCUSDT_15m.h5
2025-03-10 11:51:19,845 — model_validator — INFO — Using validation data: data/processed/BTCUSDT_15m_val.csv
2025-03-10 11:51:19,846 — model_validator — INFO — Found model at data/models/lstm_BTCUSDT_15m.keras instead of data/models/lstm_BTCUSDT_15m.h5
2025-03-10 11:51:19,846 — model_validator — INFO — Loading model from data/models/lstm_BTCUSDT_15m.keras...
2025-03-10 11:51:20,224 — model_validator — INFO — Loading validation data...
2025-03-10 11:51:20,324 — model_validator — INFO — Evaluating model performance...
2025-03-10 11:51:37,131 — model_validator — ERROR — Error during model validation: too many values to unpack (expected 2)
2025-03-10 11:51:37,133 — model_validator — ERROR — Traceback (most recent call last):
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 963, in <module>
    eval_results = validator.evaluate_on_test_set(validation_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 99, in evaluate_on_test_set
    X_test, y_test = self.feature_engineering.create_multi_horizon_data(
    ^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-10 11:54:35,916 — model_validator — INFO — Starting model validation with model: data/models/lstm_BTCUSDT_15m.h5
2025-03-10 11:54:35,917 — model_validator — INFO — Using validation data: data/processed/BTCUSDT_15m_val.csv
2025-03-10 11:54:35,918 — model_validator — INFO — Found model at data/models/lstm_BTCUSDT_15m.keras instead of data/models/lstm_BTCUSDT_15m.h5
2025-03-10 11:54:35,918 — model_validator — INFO — Loading model from data/models/lstm_BTCUSDT_15m.keras...
2025-03-10 11:54:36,290 — model_validator — INFO — Loading validation data...
2025-03-10 11:54:36,382 — model_validator — INFO — Evaluating model performance...
2025-03-10 11:54:52,047 — model_validator — ERROR — Unexpected return format from create_multi_horizon_data
2025-03-10 11:54:52,048 — model_validator — ERROR — Error during model validation: Feature engineering function returned unexpected format
2025-03-10 11:54:52,049 — model_validator — ERROR — Traceback (most recent call last):
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 995, in <module>
    eval_results = validator.evaluate_on_test_set(validation_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 112, in evaluate_on_test_set
    raise ValueError("Feature engineering function returned unexpected format")
ValueError: Feature engineering function returned unexpected format

2025-03-10 11:56:47,757 — model_validator — INFO — Starting model validation with model: data/models/lstm_BTCUSDT_15m.h5
2025-03-10 11:56:47,758 — model_validator — INFO — Using validation data: data/processed/BTCUSDT_15m_val.csv
2025-03-10 11:56:47,759 — model_validator — INFO — Found model at data/models/lstm_BTCUSDT_15m.keras instead of data/models/lstm_BTCUSDT_15m.h5
2025-03-10 11:56:47,759 — model_validator — INFO — Loading model from data/models/lstm_BTCUSDT_15m.keras...
2025-03-10 11:56:48,125 — model_validator — INFO — Loading validation data...
2025-03-10 11:56:48,216 — model_validator — INFO — Evaluating model performance...
2025-03-10 11:56:48,647 — model_validator — INFO — Creating multi-horizon data with sequence_length=30, horizons=[12, 24, 96]
2025-03-10 11:57:04,197 — model_validator — INFO — Feature engineering returned type: <class 'numpy.ndarray'>
2025-03-10 11:57:04,197 — model_validator — INFO — Return array shape: (6958, 30, 66)
2025-03-10 11:57:04,198 — model_validator — WARNING — Only X data array found, no y data - attempting to proceed without labels
2025-03-10 11:57:04,198 — model_validator — WARNING — y_test is not a list, wrapping it as a single-element list
2025-03-10 11:57:04,199 — model_validator — INFO — X_test shape: (6958, 30, 66)
2025-03-10 11:57:04,199 — model_validator — INFO — y_test[0] shape: (6958, 1)
2025-03-10 11:57:08,045 — model_validator — INFO — Results saved to reports/evaluation_lstm_BTCUSDT_15m_20250310_115708.json
2025-03-10 11:57:08,046 — model_validator — INFO — Evaluation report saved to: reports/evaluation_lstm_BTCUSDT_15m_20250310_115708.json
2025-03-10 11:57:08,046 — model_validator — INFO — Performance Summary:
2025-03-10 11:57:08,046 — model_validator — INFO —   Accuracy: 0.0000
2025-03-10 11:57:08,047 — model_validator — INFO —   F1 Score: 0.0000
2025-03-10 11:57:08,047 — model_validator — INFO —   Precision: 0.0000
2025-03-10 11:57:08,047 — model_validator — INFO —   Recall: 0.0000
2025-03-10 11:57:08,047 — model_validator — INFO — Model validation completed successfully.
2025-03-10 13:36:30,492 — model_validator — INFO — Starting model validation with model: data/models/lstm_BTCUSDT_15m.h5
2025-03-10 13:36:30,492 — model_validator — INFO — Using validation data: data/processed/BTCUSDT_15m_val.csv
2025-03-10 13:36:30,493 — model_validator — INFO — Found model at data/models/lstm_BTCUSDT_15m.keras instead of data/models/lstm_BTCUSDT_15m.h5
2025-03-10 13:36:30,493 — model_validator — INFO — Loading model from data/models/lstm_BTCUSDT_15m.keras...
2025-03-10 13:36:30,903 — model_validator — INFO — Loading validation data...
2025-03-10 13:36:31,002 — model_validator — INFO — Evaluating model performance...
2025-03-10 13:36:31,440 — model_validator — ERROR — Error during model validation: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- future_close

2025-03-10 13:36:31,486 — model_validator — ERROR — Traceback (most recent call last):
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 1046, in <module>
    eval_results = validator.evaluate_on_test_set(validation_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 111, in evaluate_on_test_set
    normalized_data = self.feature_engineering.scale_features(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\feature_engineering.py", line 327, in scale_features
    scaled_features = scaler.transform(data[feature_cols])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sklearn\preprocessing\_data.py", line 1062, in transform
    X = validate_data(
        ^^^^^^^^^^^^^^
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sklearn\utils\validation.py", line 2919, in validate_data
    _check_feature_names(_estimator, X, reset=reset)
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sklearn\utils\validation.py", line 2777, in _check_feature_names
    raise ValueError(message)
ValueError: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- future_close


2025-03-10 13:38:43,084 — model_validator — INFO — Starting model validation with model: data/models/lstm_BTCUSDT_15m.h5
2025-03-10 13:38:43,085 — model_validator — INFO — Using validation data: data/processed/BTCUSDT_15m_val.csv
2025-03-10 13:38:43,085 — model_validator — INFO — Found model at data/models/lstm_BTCUSDT_15m.keras instead of data/models/lstm_BTCUSDT_15m.h5
2025-03-10 13:38:43,086 — model_validator — INFO — Loading model from data/models/lstm_BTCUSDT_15m.keras...
2025-03-10 13:38:43,485 — model_validator — INFO — Loading validation data...
2025-03-10 13:38:43,585 — model_validator — INFO — Evaluating model performance...
2025-03-10 13:38:43,589 — model_validator — INFO — Removing 'future_close' column before feature engineering
2025-03-10 13:38:44,014 — model_validator — INFO — Normalizing features: 78 columns
2025-03-10 13:38:44,034 — model_validator — INFO — Creating multi-horizon data with sequence_length=30, horizons=[12, 24, 96]
2025-03-10 13:38:46,632 — model_validator — INFO — X_test shape: (6862, 30, 78)
2025-03-10 13:38:46,632 — model_validator — INFO — y_test[0] shape: (6862,)
2025-03-10 13:38:46,633 — model_validator — INFO — y_test[1] shape: (6862,)
2025-03-10 13:38:46,633 — model_validator — INFO — y_test[2] shape: (6862,)
2025-03-10 13:38:46,932 — model_validator — ERROR — Error during model validation: Failed to convert a NumPy array to a Tensor (Unsupported object type float).
2025-03-10 13:38:46,954 — model_validator — ERROR — Traceback (most recent call last):
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 1058, in <module>
    eval_results = validator.evaluate_on_test_set(validation_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 178, in evaluate_on_test_set
    predictions = self.model.model.predict(X_test)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\tensorflow\python\framework\constant_op.py", line 108, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Failed to convert a NumPy array to a Tensor (Unsupported object type float).

2025-03-10 13:40:52,737 — model_validator — INFO — Starting model validation with model: data/models/lstm_BTCUSDT_15m.h5
2025-03-10 13:40:52,738 — model_validator — INFO — Using validation data: data/processed/BTCUSDT_15m_val.csv
2025-03-10 13:40:52,739 — model_validator — INFO — Found model at data/models/lstm_BTCUSDT_15m.keras instead of data/models/lstm_BTCUSDT_15m.h5
2025-03-10 13:40:52,739 — model_validator — INFO — Loading model from data/models/lstm_BTCUSDT_15m.keras...
2025-03-10 13:40:53,146 — model_validator — INFO — Loading validation data...
2025-03-10 13:40:53,240 — model_validator — INFO — Evaluating model performance...
2025-03-10 13:40:53,245 — model_validator — INFO — Removing 'future_close' column before feature engineering
2025-03-10 13:40:53,689 — model_validator — INFO — Normalizing features: 78 columns
2025-03-10 13:40:53,717 — model_validator — INFO — Creating multi-horizon data with sequence_length=30, horizons=[12, 24, 96]
2025-03-10 13:40:56,473 — model_validator — INFO — X_test shape: (6862, 30, 78)
2025-03-10 13:40:56,473 — model_validator — INFO — y_test[0] shape: (6862,)
2025-03-10 13:40:56,474 — model_validator — INFO — y_test[1] shape: (6862,)
2025-03-10 13:40:56,474 — model_validator — INFO — y_test[2] shape: (6862,)
2025-03-10 13:40:56,758 — model_validator — ERROR — Error during model validation: Failed to convert a NumPy array to a Tensor (Unsupported object type float).
2025-03-10 13:40:56,760 — model_validator — ERROR — Traceback (most recent call last):
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 1058, in <module>
    eval_results = validator.evaluate_on_test_set(validation_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 178, in evaluate_on_test_set
    predictions = self.model.model.predict(X_test)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\tensorflow\python\framework\constant_op.py", line 108, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Failed to convert a NumPy array to a Tensor (Unsupported object type float).

2025-03-10 13:41:09,301 — model_validator — INFO — Starting model validation with model: data/models/lstm_BTCUSDT_15m.h5
2025-03-10 13:41:09,302 — model_validator — INFO — Using validation data: data/processed/BTCUSDT_15m_val.csv
2025-03-10 13:41:09,303 — model_validator — INFO — Found model at data/models/lstm_BTCUSDT_15m.keras instead of data/models/lstm_BTCUSDT_15m.h5
2025-03-10 13:41:09,303 — model_validator — INFO — Loading model from data/models/lstm_BTCUSDT_15m.keras...
2025-03-10 13:41:09,689 — model_validator — INFO — Loading validation data...
2025-03-10 13:41:09,783 — model_validator — INFO — Evaluating model performance...
2025-03-10 13:41:09,788 — model_validator — INFO — Removing 'future_close' column before feature engineering
2025-03-10 13:41:10,242 — model_validator — INFO — Normalizing features: 78 columns
2025-03-10 13:41:10,260 — model_validator — INFO — Creating multi-horizon data with sequence_length=30, horizons=[12, 24, 96]
2025-03-10 13:41:12,901 — model_validator — INFO — X_test shape: (6862, 30, 78)
2025-03-10 13:41:12,901 — model_validator — INFO — y_test[0] shape: (6862,)
2025-03-10 13:41:12,902 — model_validator — INFO — y_test[1] shape: (6862,)
2025-03-10 13:41:12,902 — model_validator — INFO — y_test[2] shape: (6862,)
2025-03-10 13:41:12,902 — model_validator — INFO — Validating and sanitizing input data before prediction...
2025-03-10 13:41:12,903 — model_validator — ERROR — Error during model validation: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-03-10 13:41:12,904 — model_validator — ERROR — Traceback (most recent call last):
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 1098, in <module>
    eval_results = validator.evaluate_on_test_set(validation_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 181, in evaluate_on_test_set
    if np.isnan(X_test).any() or np.isinf(X_test).any():
       ^^^^^^^^^^^^^^^^
TypeError: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''

2025-03-10 13:43:16,367 — model_validator — INFO — Starting model validation with model: data/models/lstm_BTCUSDT_15m.h5
2025-03-10 13:43:16,368 — model_validator — INFO — Using validation data: data/processed/BTCUSDT_15m_val.csv
2025-03-10 13:43:16,369 — model_validator — INFO — Found model at data/models/lstm_BTCUSDT_15m.keras instead of data/models/lstm_BTCUSDT_15m.h5
2025-03-10 13:43:16,369 — model_validator — INFO — Loading model from data/models/lstm_BTCUSDT_15m.keras...
2025-03-10 13:43:16,765 — model_validator — INFO — Loading validation data...
2025-03-10 13:43:16,856 — model_validator — INFO — Evaluating model performance...
2025-03-10 13:43:16,861 — model_validator — INFO — Removing 'future_close' column before feature engineering
2025-03-10 13:43:17,304 — model_validator — INFO — Normalizing features: 78 columns
2025-03-10 13:43:17,322 — model_validator — INFO — Creating multi-horizon data with sequence_length=30, horizons=[12, 24, 96]
2025-03-10 13:43:19,938 — model_validator — INFO — X_test shape: (6862, 30, 78)
2025-03-10 13:43:19,938 — model_validator — INFO — y_test[0] shape: (6862,)
2025-03-10 13:43:19,939 — model_validator — INFO — y_test[1] shape: (6862,)
2025-03-10 13:43:19,939 — model_validator — INFO — y_test[2] shape: (6862,)
2025-03-10 13:43:19,939 — model_validator — INFO — Validating and sanitizing input data before prediction...
2025-03-10 13:43:19,940 — model_validator — INFO — X_test dtype: object
2025-03-10 13:43:19,940 — model_validator — WARNING — X_test contains non-numeric data. Attempting to convert to float32.
2025-03-10 13:43:19,940 — model_validator — ERROR — Error during data validation: astype() got an unexpected keyword argument 'errors'
2025-03-10 13:43:19,941 — model_validator — INFO — Performing alternative data cleaning...
2025-03-10 13:43:41,256 — model_validator — INFO — Final X_test dtype: float32
2025-03-10 13:43:41,256 — model_validator — INFO — X_test shape: (6862, 30, 78)
2025-03-10 13:43:41,268 — model_validator — INFO — X_test min: -100.0, max: 44700.0
2025-03-10 13:43:41,268 — model_validator — INFO — Sample of X_test shape: (30, 78)
2025-03-10 13:43:41,268 — model_validator — INFO — Running model predictions...
2025-03-10 13:43:41,354 — model_validator — ERROR — Error in model prediction: Input 0 of layer "functional_1" is incompatible with the layer: expected shape=(None, 30, 66), found shape=(32, 30, 78)
2025-03-10 13:43:41,354 — model_validator — INFO — Examining problematic input data...
2025-03-10 13:43:41,355 — model_validator — INFO — Sample 0 shape: (30, 78), dtype: float32
2025-03-10 13:43:41,355 — model_validator — INFO — Sample 0 contains NaN: False
2025-03-10 13:43:41,355 — model_validator — INFO — Sample 0 contains inf: False
2025-03-10 13:43:41,356 — model_validator — INFO — Sample 0 min: -100.0, max: 28514.2109375
2025-03-10 13:43:41,356 — model_validator — INFO — Sample 1 shape: (30, 78), dtype: float32
2025-03-10 13:43:41,356 — model_validator — INFO — Sample 1 contains NaN: False
2025-03-10 13:43:41,356 — model_validator — INFO — Sample 1 contains inf: False
2025-03-10 13:43:41,357 — model_validator — INFO — Sample 1 min: -100.0, max: 28514.2109375
2025-03-10 13:43:41,357 — model_validator — INFO — Sample 2 shape: (30, 78), dtype: float32
2025-03-10 13:43:41,357 — model_validator — INFO — Sample 2 contains NaN: False
2025-03-10 13:43:41,358 — model_validator — INFO — Sample 2 contains inf: False
2025-03-10 13:43:41,358 — model_validator — INFO — Sample 2 min: -100.0, max: 28557.76953125
2025-03-10 13:43:41,358 — model_validator — INFO — Trying prediction with a small batch...
2025-03-10 13:43:41,405 — model_validator — ERROR — Error during debugging: Input 0 of layer "functional_1" is incompatible with the layer: expected shape=(None, 30, 66), found shape=(10, 30, 78)
2025-03-10 13:43:41,409 — model_validator — ERROR — Error during model validation: Model prediction failed: Input 0 of layer "functional_1" is incompatible with the layer: expected shape=(None, 30, 66), found shape=(32, 30, 78)
2025-03-10 13:43:41,427 — model_validator — ERROR — Traceback (most recent call last):
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 242, in evaluate_on_test_set
    predictions = self.model.model.predict(X_test)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\timot\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\keras\src\layers\input_spec.py", line 245, in assert_input_compatibility
    raise ValueError(
ValueError: Input 0 of layer "functional_1" is incompatible with the layer: expected shape=(None, 30, 66), found shape=(32, 30, 78)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 1144, in <module>
    eval_results = validator.evaluate_on_test_set(validation_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\timot\OneDrive\Bureau\BOT TRADING BIG 2025\crypto_trading_bot_CLAUDE\ai\models\model_validator.py", line 264, in evaluate_on_test_set
    raise ValueError(f"Model prediction failed: {str(e)}")
ValueError: Model prediction failed: Input 0 of layer "functional_1" is incompatible with the layer: expected shape=(None, 30, 66), found shape=(32, 30, 78)

2025-03-10 13:46:32,792 — model_validator — INFO — Starting model validation with model: data/models/lstm_BTCUSDT_15m.h5
2025-03-10 13:46:32,792 — model_validator — INFO — Using validation data: data/processed/BTCUSDT_15m_val.csv
2025-03-10 13:46:32,793 — model_validator — INFO — Found model at data/models/lstm_BTCUSDT_15m.keras instead of data/models/lstm_BTCUSDT_15m.h5
2025-03-10 13:46:32,793 — model_validator — INFO — Loading model from data/models/lstm_BTCUSDT_15m.keras...
2025-03-10 13:46:33,176 — model_validator — INFO — Loading validation data...
2025-03-10 13:46:33,268 — model_validator — INFO — Evaluating model performance...
2025-03-10 13:46:33,273 — model_validator — INFO — Removing 'future_close' column before feature engineering
2025-03-10 13:46:33,697 — model_validator — INFO — Normalizing features: 78 columns
2025-03-10 13:46:33,714 — model_validator — INFO — Creating multi-horizon data with sequence_length=30, horizons=[12, 24, 96]
2025-03-10 13:46:36,323 — model_validator — INFO — X_test shape: (6862, 30, 78)
2025-03-10 13:46:36,323 — model_validator — INFO — y_test[0] shape: (6862,)
2025-03-10 13:46:36,324 — model_validator — INFO — y_test[1] shape: (6862,)
2025-03-10 13:46:36,324 — model_validator — INFO — y_test[2] shape: (6862,)
2025-03-10 13:46:36,324 — model_validator — INFO — Validating and sanitizing input data before prediction...
2025-03-10 13:46:36,325 — model_validator — INFO — X_test dtype: object
2025-03-10 13:46:36,325 — model_validator — WARNING — X_test contains non-numeric data. Attempting to convert to float32.
2025-03-10 13:46:38,872 — model_validator — WARNING — Feature dimension mismatch! Model expects 66 features, but input has 78 features.
2025-03-10 13:46:38,872 — model_validator — INFO — Trimming input features from 78 to 66
2025-03-10 13:46:38,873 — model_validator — INFO — Final X_test shape: (6862, 30, 66)
2025-03-10 13:46:38,873 — model_validator — INFO — Final X_test dtype: float32
2025-03-10 13:46:38,886 — model_validator — INFO — X_test min: -100.0, max: 44700.0
2025-03-10 13:46:38,887 — model_validator — INFO — Sample of X_test shape: (30, 66)
2025-03-10 13:46:38,887 — model_validator — INFO — Running model predictions...
2025-03-10 13:46:42,929 — model_validator — INFO — Results saved to reports/evaluation_lstm_BTCUSDT_15m_20250310_134642.json
2025-03-10 13:46:42,930 — model_validator — INFO — Evaluation report saved to: reports/evaluation_lstm_BTCUSDT_15m_20250310_134642.json
2025-03-10 13:46:42,931 — model_validator — INFO — Performance Summary:
2025-03-10 13:46:42,931 — model_validator — INFO —   Accuracy: 0.5238
2025-03-10 13:46:42,932 — model_validator — INFO —   F1 Score: 0.6875
2025-03-10 13:46:42,932 — model_validator — INFO —   Precision: 0.5238
2025-03-10 13:46:42,932 — model_validator — INFO —   Recall: 1.0000
2025-03-10 13:46:42,933 — model_validator — INFO — Model validation completed successfully.
